<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start Screen</title>
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Press+Start+2P&display=swap" rel="stylesheet">
</head>

<body>
    <main>
        <div id="start-screen">
            <img src="images/code_logo.png" alt="失われし文字" class="game-logo">
            
            <div class="difficulty-selector">
                <a href="select2.html" class="btn easy-btn">easy</a>
                
                <a href="select.html" class="btn normal-btn">normal</a>
            </div>
        </div>
    </main>
    <script>
        // ★修正: ゲーム開始時に「両方」のモードのデータをクリア
        function clearAllGameData() {
            try {
                // --- localStorage のクリア (既存) ---
                localStorage.removeItem('slate_quest_answers_v1_normal');
                localStorage.removeItem('slate_quest_state_v1_normal');
                localStorage.removeItem('startTime_normal');
                localStorage.removeItem('finalClearTime_normal');
                localStorage.removeItem('finalMistakeCount_normal');
    
                localStorage.removeItem('slate_quest_answers_v1_easy');
                localStorage.removeItem('slate_quest_state_v1_easy');
                localStorage.removeItem('startTime_easy');
                localStorage.removeItem('finalClearTime_easy');
                localStorage.removeItem('finalMistakeCount_easy');
                
                localStorage.removeItem('slate_quest_answers_v1');
                localStorage.removeItem('slate_quest_state_v1');
                localStorage.removeItem('startTime');

                // ★★★ ここから追加 ★★★
                // --- sessionStorage のクリア (Normalモードの問題パターン) ---
                // (slate.js で定義されているキー)
                sessionStorage.removeItem('gimmick1_combination');
                sessionStorage.removeItem('gimmick2_combination');
                sessionStorage.removeItem('gimmick3_combination');
                sessionStorage.removeItem('gimmick4_combination');
                // ★★★ ここまで追加 ★★★
    
            } catch (e) {
                console.warn("ストレージのクリアに失敗:", e);
            }
        }
    
        // ★追加: ボタンにイベントリスナーを設定
        const easyBtn = document.querySelector('.easy-btn');
        const normalBtn = document.querySelector('.normal-btn');
    
        if (easyBtn) {
            easyBtn.addEventListener('click', (e) => {
                e.preventDefault(); 
                clearAllGameData();
                sessionStorage.setItem('gameMode', 'easy');
                window.location.href = easyBtn.href;
            });
        }
    
        if (normalBtn) {
            normalBtn.addEventListener('click', (e) => {
                e.preventDefault();
                clearAllGameData();
                sessionStorage.setItem('gameMode', 'normal');
                window.location.href = normalBtn.href;
            });
        }
    </script>
</body>
</html>